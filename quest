есть папка с фотками
разного формата

задача 1.
Генерировать из разных по размеру фоток превью 400х400 (фотки не будут меньше чем 400пк по любой из сторон)

условие к задаче 1 - качество jpg превью 90%.
генерация только если превью для картинки ещё нет! не надо генерить их всякий раз при обращении к скрипту.

задача 2 - немного не так сформулировал. мне нужен короч массив с путями к фоткам из которого я смогу сделать src